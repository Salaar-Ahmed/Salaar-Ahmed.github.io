<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>For Sara · my Valentine </title>
  <style>
    /* ===== CRAFTED WITH LOVE FOR SARA ===== (all existing styles preserved, enhanced) */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --whisper: #F2EAF7;
      --wisteria: #C59DD9;
      --velvet: #7A3F91;
      --sacred: #2B0D3E;

      --transition-slow: 1.2s cubic-bezier(0.2, 0.9, 0.3, 1);
      --transition-ceremony: 0.9s cubic-bezier(0.25, 0.46, 0.45, 0.94);

      --font-serif: 'Georgia', 'Times New Roman', serif;
      --font-sans: 'Avenir', 'Segoe UI', 'Roboto', system-ui, sans-serif;

      --glass-bg: rgba(242, 234, 247, 0.12);
      --glass-border: rgba(197, 157, 217, 0.25);
      --card-shadow: 0 30px 60px -20px rgba(43, 13, 62, 0.6), 0 0 0 1px rgba(197, 157, 217, 0.2) inset;
      
      --space-xs: 0.5rem;
      --space-sm: 0.8rem;
      --space-md: 1.2rem;
      --space-lg: 1.8rem;
      --space-xl: 2.2rem;
    }

    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--sacred);
      font-family: var(--font-sans);
      color: var(--whisper);
      padding: var(--space-sm);
      margin: 0;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 40% 50%, var(--velvet) 0%, var(--sacred) 80%);
      filter: blur(8px);
      opacity: 0.9;
      z-index: -2;
      animation: galaxyBreath 12s infinite alternate ease-in-out;
    }

    @keyframes galaxyBreath {
      0% { transform: scale(1); opacity: 0.7; background: radial-gradient(circle at 30% 60%, #8a4ba0, #2B0D3E); }
      100% { transform: scale(1.08); opacity: 1; background: radial-gradient(circle at 60% 40%, #b47bc9, #351a47); }
    }

    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="1" stitchTiles="stitch"/><feColorMatrix type="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0.05 0"/></filter><rect width="100" height="100" filter="url(%23noise)" opacity="0.12"/></svg>');
      opacity: 0.1;
      pointer-events: none;
      z-index: -1;
      mix-blend-mode: overlay;
    }

    .canvas {
      width: 100%;
      max-width: 420px;
      aspect-ratio: 9 / 16;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* VENETIAN GLASS CARD — with relative positioning for ribbon overlays */
    .card {
      width: 100%;
      height: 100%;
      background: var(--glass-bg);
      backdrop-filter: blur(24px) saturate(180%);
      -webkit-backdrop-filter: blur(24px) saturate(180%);
      border-radius: min(42px, 8vw) min(42px, 8vw) min(38px, 7vw) min(38px, 7vw);
      border: 1px solid var(--glass-border);
      box-shadow: var(--card-shadow);
      padding: clamp(1.2rem, 6vw, 2.2rem) clamp(1rem, 5vw, 1.8rem);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: box-shadow 0.5s, border-color 0.5s;
      position: relative;
      overflow: hidden;          /* keeps ribbon edges rounded, ribbon absolute inside */
    }

    /* --- ELEGANT RIBBON FRAME (4 sides, using the same image) --- */
    .ribbon-corner {
      position: absolute;
      width: 40%;                /* responsive scaling */
      max-width: 160px;
      height: auto;
      pointer-events: none;
      z-index: 12;               /* above background, below text (text z-index 15) */
      opacity: 0.8;
      filter: drop-shadow(0 4px 12px rgba(197, 157, 217, 0.4));
    }

    .ribbon-corner--tl {
      top: -6px;
      left: -10px;
      transform: rotate(-15deg) scaleX(-1); /* flip to frame top-left */
      width: 45%;
    }

    .ribbon-corner--tr {
      top: -8px;
      right: -12px;
      transform: rotate(25deg) scaleX(-1);
      width: 44%;
    }

    .ribbon-corner--bl {
      bottom: -12px;
      left: -10px;
      transform: rotate(-25deg) scaleX(-1);
      width: 46%;
    }

    .ribbon-corner--br {
      bottom: -10px;
      right: -14px;
      transform: rotate(15deg);
      width: 45%;
    }

    /* additional smaller ribbons to wrap edges seamlessly */
    .ribbon-edge {
      position: absolute;
      width: 28%;
      max-width: 100px;
      pointer-events: none;
      z-index: 12;
      opacity: 0.7;
    }

    .ribbon-edge--top {
      top: -12px;
      left: 30%;
      transform: rotate(0deg) scaleX(1);
      width: 35%;
    }

    .ribbon-edge--bottom {
      bottom: -14px;
      left: 35%;
      transform: rotate(180deg);
      width: 38%;
    }

    /* --- FLOATING PURPLE FLOWER (ORBIT) --- */
    .floating-flower {
      position: absolute;
      width: 90px;
      height: 90px;
      background: url('https://i.postimg.cc/rFyvmh62/1000175616-removebg-preview.png') no-repeat center/contain;
      opacity: 0.28;              /* subtle, semi-transparent */
      pointer-events: none;
      z-index: 10;                /* behind text but above background orbs */
      filter: drop-shadow(0 0 12px #b380cc) brightness(1.2);
      animation: orbitFlower 22s infinite linear; /* elegant slow orbit */
    }

    @keyframes orbitFlower {
      0% {
        transform: translate(0, 0) rotate(0deg) scale(1);
        left: 20%; top: 20%;
      }
      25% {
        left: 70%; top: 15%;
        transform: rotate(30deg) scale(1.02);
      }
      50% {
        left: 80%; top: 60%;
        transform: rotate(60deg) scale(0.98);
      }
      75% {
        left: 30%; top: 80%;
        transform: rotate(90deg) scale(1.02);
      }
      100% {
        left: 20%; top: 20%;
        transform: rotate(120deg) scale(1);
      }
    }

    /* text & content layer must be above ribbons and flower */
    .scene, .gestures, .letter, .spotify-player, .micro-response {
      z-index: 15;
      position: relative;  /* ensure stacking */
    }

    /* particle field lower z */
    .particle-field {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(20px);
      opacity: 0.5;
      background: radial-gradient(circle at 30% 30%, var(--wisteria), rgba(197, 157, 217, 0.1));
      animation: floatOrb 16s infinite alternate ease-in-out;
    }

    @keyframes floatOrb {
      0% { transform: translate(0, 0) scale(1); }
      100% { transform: translate(6%, 8%) scale(1.2); }
    }

    .scene {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: opacity var(--transition-slow), transform var(--transition-slow);
      z-index: 15;
    }

    .scene--hidden {
      opacity: 0;
      transform: scale(0.96);
      pointer-events: none;
      position: absolute;
    }

    /* SCROLLABLE AREAS inside card (letter body & dua) */
    .letter-body-scroll {
      max-height: 30vh;          /* flexible for 9:16 */
      overflow-y: auto;
      padding-right: 6px;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      background: rgba(43, 13, 62, 0.2); /* slight background to differentiate */
      border-radius: inherit;
    }

    .letter-body-scroll::-webkit-scrollbar {
      width: 4px;
    }

    .letter-body-scroll::-webkit-scrollbar-track {
      background: rgba(197, 157, 217, 0.1);
      border-radius: 8px;
    }

    .letter-body-scroll::-webkit-scrollbar-thumb {
      background: var(--wisteria);
      border-radius: 8px;
    }

    .dua-scroll {
      max-height: 12vh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      padding: 0.4rem 0.8rem;
    }

    .dua-scroll::-webkit-scrollbar {
      width: 3px;
    }

    /* typography and rest unchanged from original, but scroll applied */
    .proposition {
      text-align: center;
      width: 100%;
    }

    .greeting {
      font-family: var(--font-serif);
      font-weight: 400;
      font-size: clamp(1rem, 5vw, 1.8rem);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--wisteria);
      margin-bottom: var(--space-xs);
      opacity: 0.8;
      text-shadow: 0 0 12px rgba(197, 157, 217, 0.5);
    }

    .name {
      font-size: clamp(2rem, 10vw, 3.8rem);
      font-family: var(--font-serif);
      font-weight: 400;
      line-height: 1.1;
      color: var(--whisper);
      margin-bottom: var(--space-xs);
      text-shadow: 0 0 18px rgba(255, 240, 250, 0.6);
      letter-spacing: -0.01em;
      word-break: break-word;
    }

    .question {
      font-size: clamp(1rem, 4vw, 1.2rem);
      margin: var(--space-md) 0 var(--space-lg);
      font-style: italic;
      color: rgba(242, 234, 247, 0.9);
      border-top: 1px solid rgba(197, 157, 217, 0.3);
      border-bottom: 1px solid rgba(197, 157, 217, 0.3);
      padding: var(--space-sm) 0;
      max-width: min(280px, 80%);
      margin-left: auto;
      margin-right: auto;
      font-weight: 300;
      backdrop-filter: blur(4px);
    }

    .gestures {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      gap: clamp(1.5rem, 8vw, 2.5rem);
      margin-top: var(--space-sm);
      width: 100%;
      flex-wrap: wrap;
    }

    .gesture {
      border: none;
      background: transparent;
      font-family: var(--font-serif);
      font-size: clamp(1.8rem, 7vw, 2.2rem);
      font-weight: 300;
      padding: clamp(0.3rem, 2vw, 0.4rem) clamp(0.5rem, 3vw, 1rem);
      cursor: pointer;
      transition: all var(--transition-ceremony);
      position: relative;
      color: var(--whisper);
      text-shadow: 0 0 10px currentColor;
      letter-spacing: 0.2rem;
      line-height: 1;
      border-radius: 4px;
    }

    .gesture:focus-visible {
      outline: 3px solid var(--wisteria);
      outline-offset: 4px;
      border-radius: 4px;
    }

    .gesture--yes {
      font-size: clamp(2.5rem, 9vw, 3.2rem);
      font-weight: 400;
      color: #fff;
      text-shadow: 0 0 24px var(--wisteria), 0 4px 12px rgba(122, 63, 145, 0.6);
    }

    .gesture--yes:hover,
    .gesture--yes:focus-visible {
      transform: scale(1.08);
      color: #ffffff;
      text-shadow: 0 0 32px #f2d3ff;
    }

    .gesture--no {
      font-size: clamp(1.6rem, 6vw, 2rem);
      color: rgba(242, 234, 247, 0.55);
      text-shadow: none;
      font-style: italic;
    }

    .gesture--no:hover,
    .gesture--no:focus-visible {
      color: var(--wisteria);
      text-shadow: 0 0 12px var(--velvet);
    }

    .micro-response {
      min-height: 70px;
      margin-top: var(--space-md);
      font-size: clamp(0.9rem, 3.5vw, 1.1rem);
      font-style: italic;
      color: var(--wisteria);
      opacity: 0;
      transition: opacity 0.9s ease, text-shadow 0.5s, transform 0.3s ease;
      text-align: center;
      padding: 0 var(--space-sm);
      letter-spacing: 0.03em;
      max-width: min(300px, 90%);
      transform: translateY(10px);
      z-index: 20;
    }

    .micro-response--visible {
      opacity: 1;
      text-shadow: 0 0 16px #f0c4ff, 0 0 4px white;
      transform: translateY(0);
    }

    /* scene 2 letter */
    .letter {
      text-align: center;
      width: 100%;
    }

    .letter-head {
      font-family: var(--font-serif);
      font-size: clamp(1.5rem, 6vw, 1.9rem);
      margin-bottom: 0.25rem;
      color: var(--whisper);
      text-shadow: 0 0 20px #b692cf;
      word-break: break-word;
    }

    .letter-sub {
      color: var(--wisteria);
      font-size: clamp(0.8rem, 3vw, 1rem);
      letter-spacing: 0.3rem;
      text-transform: uppercase;
      margin-bottom: clamp(1rem, 4vw, 2rem);
      word-break: break-word;
    }

    .letter-body {
      font-size: clamp(0.9rem, 3.5vw, 1.1rem);
      line-height: 1.8;
      color: rgba(255, 255, 255, 0.9);
      background: rgba(43, 13, 62, 0.3);
      backdrop-filter: blur(8px);
      padding: clamp(1rem, 4vw, 1.8rem) clamp(0.8rem, 3vw, 1.2rem);
      border-radius: min(40px, 6vw) min(20px, 4vw) min(40px, 6vw) min(20px, 4vw);
      border: 1px solid rgba(197, 157, 217, 0.3);
      margin: var(--space-sm) 0 var(--space-xs);
      font-weight: 300;
      box-shadow: 0 15px 35px -10px black;
    }

    /* scrollable wrapper for long paragraphs */
    .scrollable-wrapper {
      max-height: 30vh;
      overflow-y: auto;
      padding-right: 4px;
      -webkit-overflow-scrolling: touch;
    }

    .dua {
      font-family: var(--font-serif);
      font-size: clamp(1rem, 4vw, 1.2rem);
      font-style: italic;
      color: #e8d1ff;
      background: rgba(122, 63, 145, 0.2);
      border-radius: min(60px, 10vw);
      padding: clamp(0.6rem, 3vw, 0.8rem) clamp(1rem, 4vw, 1.5rem);
      margin-top: var(--space-xs);
      backdrop-filter: blur(4px);
      border: 1px dashed var(--wisteria);
      line-height: 1.5;
    }

    .shimmer-effect {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      background: radial-gradient(circle at var(--x, 50%) var(--y, 50%), rgba(255, 230, 240, 0.3) 0%, transparent 60%);
      opacity: 0;
      transition: opacity 0.6s;
      z-index: 10;
      border-radius: inherit;
    }

    .shimmer-effect.active {
      opacity: 1;
    }

    /* ===== NEW: SPOTIFY PLAYER STYLES ===== */
    .spotify-player {
      position: absolute;
      bottom: clamp(8px, 3vh, 15px);
      left: 0;
      width: 100%;
      z-index: 20;
      padding: 0 clamp(8px, 3vw, 15px);
      pointer-events: none;
    }

    .spotify-embed {
      width: 100%;
      height: 80px;
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5), 0 0 0 1px rgba(197, 157, 217, 0.3);
      transition: all 0.3s ease;
      pointer-events: auto;
      backdrop-filter: blur(5px);
    }

    .spotify-embed:hover {
      box-shadow: 0 15px 40px -10px rgba(197, 157, 217, 0.4), 0 0 0 1px var(--wisteria);
      transform: translateY(-2px);
    }

    .spotify-embed iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      border-radius: 12px;
    }



    /* ===== NEW: EXTRA STUNNING FEATURES ===== */
    .top-badges {
      position: absolute;
      top: clamp(10px, 2vh, 16px);
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 0.6rem;
      z-index: 30;
      align-items: center;
    }

    .badge {
      border: 1px solid rgba(197, 157, 217, 0.5);
      background: rgba(43, 13, 62, 0.55);
      color: var(--whisper);
      font-size: 0.68rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      border-radius: 999px;
      padding: 0.35rem 0.7rem;
      backdrop-filter: blur(6px);
      box-shadow: 0 8px 18px -10px rgba(0, 0, 0, 0.8);
      white-space: nowrap;
    }

    .theme-toggle {
      border: 1px solid rgba(197, 157, 217, 0.5);
      background: rgba(242, 234, 247, 0.16);
      color: var(--whisper);
      border-radius: 999px;
      font-size: 0.72rem;
      padding: 0.35rem 0.65rem;
      cursor: pointer;
      transition: transform 0.25s ease, background 0.25s ease;
    }

    .theme-toggle:hover,
    .theme-toggle:focus-visible {
      transform: translateY(-1px);
      background: rgba(197, 157, 217, 0.4);
      outline: none;
    }

    .love-meter {
      width: min(260px, 86%);
      margin: 0.7rem auto 0;
      text-align: left;
      z-index: 20;
    }

    .love-meter__label {
      display: block;
      font-size: 0.68rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: rgba(242, 234, 247, 0.85);
      margin-bottom: 0.35rem;
    }

    .love-meter__track {
      height: 8px;
      border-radius: 999px;
      background: rgba(242, 234, 247, 0.2);
      overflow: hidden;
      box-shadow: inset 0 0 0 1px rgba(197, 157, 217, 0.25);
    }

    .love-meter__fill {
      display: block;
      height: 100%;
      width: 12%;
      border-radius: inherit;
      background: linear-gradient(90deg, #d8a4f0, #f8dcff);
      transition: width 0.35s ease;
      box-shadow: 0 0 14px rgba(242, 211, 255, 0.9);
    }

    .sparkle {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      pointer-events: none;
      background: radial-gradient(circle, #ffe8ff 10%, #c590e0 70%, transparent 75%);
      animation: sparkleFall 1400ms ease-out forwards;
      z-index: 25;
    }

    @keyframes sparkleFall {
      0% { opacity: 1; transform: translateY(0) scale(1); }
      100% { opacity: 0; transform: translateY(36px) scale(0.3); }
    }

    body.theme-dawn::before {
      background: radial-gradient(circle at 45% 30%, #dca8f2 0%, #47245e 75%);
    }

    /* responsive adjustments for Spotify player */
    @media (max-width: 360px) {
      .spotify-embed {
        height: 72px;
      }
    }

    @media (max-width: 320px) {
      :root {
        --space-xs: 0.3rem; --space-sm: 0.5rem; --space-md: 0.8rem; --space-lg: 1.2rem; --space-xl: 1.5rem;
      }
      .gestures { gap: 1rem; }
      .micro-response { min-height: 80px; }
      .spotify-embed {
        height: 64px;
      }
    }

    @media (max-height: 600px) and (orientation: landscape) {
      .canvas { aspect-ratio: auto; max-height: 95vh; }
      .spotify-embed {
        height: 60px;
      }
    }
  </style>
</head>
<body>
  <div class="canvas">
    <div class="card" role="main" aria-label="Valentine's Day interactive card for Sara">
      
      <!-- RIBBON FRAME (elegant, wraps all sides, using provided PNG) -->
      <img src="https://i.postimg.cc/3JrPRtsb/1000175617-removebg-preview.png" alt="" class="ribbon-corner ribbon-corner--tl" aria-hidden="true">
      <img src="https://i.postimg.cc/3JrPRtsb/1000175617-removebg-preview.png" alt="" class="ribbon-corner ribbon-corner--tr" aria-hidden="true">
      <img src="https://i.postimg.cc/3JrPRtsb/1000175617-removebg-preview.png" alt="" class="ribbon-corner ribbon-corner--bl" aria-hidden="true">
      <img src="https://i.postimg.cc/3JrPRtsb/1000175617-removebg-preview.png" alt="" class="ribbon-corner ribbon-corner--br" aria-hidden="true">
      <img src="https://i.postimg.cc/3JrPRtsb/1000175617-removebg-preview.png" alt="" class="ribbon-edge ribbon-edge--top" aria-hidden="true">
      <img src="https://i.postimg.cc/3JrPRtsb/1000175617-removebg-preview.png" alt="" class="ribbon-edge ribbon-edge--bottom" aria-hidden="true">

      <!-- FLOATING PURPLE FLOWER (orbit) -->
      <div class="floating-flower" aria-hidden="true"></div>

      <!-- floating orbs (preserved) -->
      <div class="particle-field" id="particleField" aria-hidden="true"></div>

      <div class="top-badges" aria-label="love controls">
        <span class="badge" id="countdownBadge">forever starts now</span>
        <button class="theme-toggle" id="themeToggle" type="button" aria-label="Toggle dreamy color mode">Dream Mode</button>
      </div>

      <!-- Scene 1: Proposition -->
      <div id="scene1" class="scene proposition" role="region" aria-labelledby="greetingText" aria-hidden="false">
        <div class="greeting" id="greetingText">hey love, you make my heart do cartwheels</div>
        <div class="name" aria-label="Sara Khan">Sara Khan</div>
        <div class="question" id="questionText">will you be my Valentine, pretty please?</div>

        <div class="gestures" role="group" aria-label="Response options">
          <button class="gesture gesture--yes" id="yesBtn" aria-label="Say yes to being Valentine" tabindex="0">YES</button>
          <button class="gesture gesture--no" id="noBtn" aria-label="Not ready yet, but that's okay" tabindex="0">NO</button>
        </div>

        <div id="microResponse" class="micro-response" role="status" aria-live="polite" aria-atomic="true"></div>

        <div class="love-meter" aria-live="polite">
          <span class="love-meter__label" id="loveMeterLabel">love meter: 12%</span>
          <div class="love-meter__track" aria-hidden="true">
            <span class="love-meter__fill" id="loveMeterFill"></span>
          </div>
        </div>
      </div>

      <!-- Scene 2: Valentine's Letter with SCROLLABLE content -->
      <div id="scene2" class="scene scene--hidden letter" role="region" aria-labelledby="letterHead" aria-hidden="true">
        <div class="letter-head" id="letterHead">My Dearest Sara</div>
        <div class="letter-sub" id="letterSub">happy Valentine's Day, Zarghyy</div>
        <!-- scrollable letter body -->
        <div class="letter-body scrollable-wrapper" id="letterBody" role="article">
          i still catch myself smiling when i think of ur laugh. u turn ordinary moments into adventures, and ur eyes… damn, they pull me in every time. today, i just want u to know that you're my favorite part of every day. i'm crazy about u, always.<br><br>
          every glance from u feels like coming home. i remember the way u tilt ur head when you're curious, how ur nose crinkles when you're holding back a laugh. i want to collect all those fragments of u and keep them close, like sacred relics. being with you has taught me that love isn't just a word .... it's the quiet peace between heartbeats. u are my sanctuary, my sweetest kharoos masaat, my most beautiful truth.
        </div>
        <!-- scrollable dua (extra care) -->
        <div class="dua dua-scroll" id="dua" role="note" aria-label="Prayer for our future">
          May our hearts stay tangled forever, and may we never stop making each other smile. may every sunrise bring us closer, every twilight wrap us in gratitude. i pray that our love becomes a gentle river, never rushing but always flowing, carrying us through all seasons.
        </div>
      </div>

      <div id="shimmer" class="shimmer-effect" aria-hidden="true"></div>

      <!-- ===== SPOTIFY PLAYER (the song you requested) ===== -->
      <div class="spotify-player">
        <div class="spotify-embed">
          <!-- Embedded Spotify track: "Die With A Smile" by Lady Gaga & Bruno Mars -->
          <iframe src="https://open.spotify.com/embed/track/2plbrEY59IikOBgBGLjaoe?utm_source=oembed" allow="clipboard-write *; encrypted-media *; fullscreen *; picture-in-picture *;" loading="lazy" title="Spotify player - Die With A Smile"></iframe>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function() {
      "use strict";
      
      const elements = {
        scene1: document.getElementById('scene1'),
        scene2: document.getElementById('scene2'),
        yesBtn: document.getElementById('yesBtn'),
        noBtn: document.getElementById('noBtn'),
        micro: document.getElementById('microResponse'),
        shimmer: document.getElementById('shimmer'),
        particleField: document.getElementById('particleField'),
        countdownBadge: document.getElementById('countdownBadge'),
        themeToggle: document.getElementById('themeToggle'),
        loveMeterFill: document.getElementById('loveMeterFill'),
        loveMeterLabel: document.getElementById('loveMeterLabel'),
        card: document.querySelector('.card')
      };

      let constellationTimer = null;
      const TRANSITION_MS = 1200;
      const LOVE_START = 12;
      const LOVE_MAX = 100;
      let loveMeter = LOVE_START;
      
      const microResponses = [
        "no worries, my heart's happy just seeing you smile.",
        "take your time, i can wait forever for you.",
        "even if you hesitate, i'm already yours in spirit.",
        "i get it, patience is part of love's game.",
        "your 'not yet' makes me cherish you even more.",
        "take all the time you need, i'm not going anywhere.",
        "every moment waiting for you just feels sweet."
      ];

      function initParticles() {
        if (!elements.particleField) return;
        elements.particleField.innerHTML = '';
        const particles = [
          { top: '5%', left: '5%', width: 180, height: 180, duration: 18, color: '#d9b0e8', delay: 0 },
          { bottom: '10%', right: '0%', width: 240, height: 240, duration: 22, color: '#b887cf', opacity: 0.4, delay: -3 },
          { top: '30%', right: '15%', width: 110, height: 110, duration: 14, color: '#f2d9ff', delay: 0 }
        ];
        
        particles.forEach(config => {
          const orb = document.createElement('div');
          orb.className = 'orb';
          Object.assign(orb.style, {
            top: config.top || 'auto',
            left: config.left || 'auto',
            bottom: config.bottom || 'auto',
            right: config.right || 'auto',
            width: config.width + 'px',
            height: config.height + 'px',
            background: `radial-gradient(circle, ${config.color}, transparent 75%)`,
            opacity: config.opacity || 0.5,
            animationDuration: config.duration + 's',
            animationDelay: config.delay + 's'
          });
          elements.particleField.appendChild(orb);
        });
      }

      function showScene(targetScene, hideScene) {
        if (targetScene === elements.scene2) {
          elements.scene1.setAttribute('aria-hidden', 'true');
          elements.scene2.setAttribute('aria-hidden', 'false');
        }
        targetScene.classList.remove('scene--hidden');
        void hideScene.offsetWidth;
        hideScene.style.opacity = '0';
        hideScene.style.transform = 'scale(0.96)';
        targetScene.style.opacity = '1';
        targetScene.style.transform = 'scale(1)';
        setTimeout(() => {
          if (hideScene.style.opacity === '0') {
            hideScene.classList.add('scene--hidden');
          }
        }, TRANSITION_MS * 0.8);
      }

      function activateShimmer(event) {
        if (!elements.shimmer) return;
        if (event) {
          const rect = event.target.getBoundingClientRect();
          const x = ((rect.left + rect.width/2) / window.innerWidth) * 100;
          const y = ((rect.top + rect.height/2) / window.innerHeight) * 100;
          elements.shimmer.style.setProperty('--x', x + '%');
          elements.shimmer.style.setProperty('--y', y + '%');
        } else {
          elements.shimmer.style.setProperty('--x', '50%');
          elements.shimmer.style.setProperty('--y', '70%');
        }
        elements.shimmer.classList.add('active');
        if (constellationTimer) clearTimeout(constellationTimer);
        constellationTimer = setTimeout(() => {
          elements.shimmer.classList.remove('active');
        }, 1800);
      }

      function animateButton(button, scale = 1.08, color = 'var(--wisteria)') {
        if (!button) return;
        button.style.transform = `scale(${scale})`;
        if (color) button.style.color = color;
        setTimeout(() => {
          button.style.transform = 'scale(1)';
          button.style.color = '';
        }, 300);
      }

      function showMicroResponse() {
        if (!elements.micro) return;
        const randomIdx = Math.floor(Math.random() * microResponses.length);
        elements.micro.textContent = '✦ ' + microResponses[randomIdx] + ' ✦';
        elements.micro.classList.add('micro-response--visible');
      }

      function hideMicroResponse() {
        if (!elements.micro) return;
        elements.micro.classList.remove('micro-response--visible');
      }

      function handleYes() {
        if (elements.shimmer) elements.shimmer.classList.remove('active');
        hideMicroResponse();
        showScene(elements.scene2, elements.scene1);
        setLoveMeter(LOVE_MAX);
        burstSparkles();
        const ann = document.createElement('div');
        ann.setAttribute('role', 'status'); ann.textContent = 'Showing Valentine\'s letter for Sara';
        document.body.appendChild(ann); setTimeout(() => ann.remove(), 1000);
      }

      function handleNo(event) {
        if (elements.scene1.classList.contains('scene--hidden')) return;
        showMicroResponse();
        activateShimmer(event);
        animateButton(elements.noBtn);
        setLoveMeter(loveMeter + 7);
      }

      function handleKeyDown(event) {
        if (event.key === 'Escape') {
          hideMicroResponse();
          if (elements.shimmer) elements.shimmer.classList.remove('active');
        }
      }

      function setLoveMeter(value) {
        loveMeter = Math.max(LOVE_START, Math.min(LOVE_MAX, value));
        if (elements.loveMeterFill) elements.loveMeterFill.style.width = loveMeter + '%';
        if (elements.loveMeterLabel) elements.loveMeterLabel.textContent = 'love meter: ' + loveMeter + '%';
      }

      function updateCountdownBadge() {
        if (!elements.countdownBadge) return;
        const now = new Date();
        const target = new Date(now.getFullYear(), 1, 14, 0, 0, 0);
        if (now > target) target.setFullYear(target.getFullYear() + 1);
        const days = Math.ceil((target - now) / (1000 * 60 * 60 * 24));
        elements.countdownBadge.textContent = days + " days until valentine's magic";
      }

      function burstSparkles() {
        if (!elements.card) return;
        for (let i = 0; i < 24; i += 1) {
          const sparkle = document.createElement('span');
          sparkle.className = 'sparkle';
          sparkle.style.left = (10 + Math.random() * 80) + '%';
          sparkle.style.top = (18 + Math.random() * 62) + '%';
          sparkle.style.animationDelay = (Math.random() * 120) + 'ms';
          elements.card.appendChild(sparkle);
          setTimeout(() => sparkle.remove(), 1500);
        }
      }

      function toggleTheme() {
        document.body.classList.toggle('theme-dawn');
      }

      function init() {
        initParticles();
        elements.scene1.style.opacity = '1'; elements.scene1.style.transform = 'scale(1)';
        elements.scene2.style.opacity = '0'; elements.scene2.style.transform = 'scale(0.96)';
        elements.scene1.setAttribute('aria-hidden', 'false');
        elements.scene2.setAttribute('aria-hidden', 'true');
        elements.yesBtn.addEventListener('click', handleYes);
        elements.noBtn.addEventListener('click', handleNo);
        if (elements.themeToggle) elements.themeToggle.addEventListener('click', toggleTheme);
        document.addEventListener('keydown', handleKeyDown);
        
        setLoveMeter(LOVE_START);
        updateCountdownBadge();
        window.setInterval(updateCountdownBadge, 60000);

        // Touch optimization
        window.addEventListener('touchstart', () => {}, { passive: true });
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
